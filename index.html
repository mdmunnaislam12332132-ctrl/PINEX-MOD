<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>PINEX MINI MOD</title>
    <style>
        * { -webkit-tap-highlight-color: transparent; user-select: none; box-sizing: border-box; }
        body, html { margin: 0; padding: 0; height: 100%; width: 100%; overflow: hidden; background: #000; font-family: monospace; }
        #game-frame { position: absolute; top: 0; left: 0; width: 100%; height: 100%; border: none; z-index: 1; }
        .draggable { position: absolute; z-index: 10000; touch-action: none; cursor: move; }

        /* SKULL BUTTON */
        #main-skull {
            top: 20%; left: 10px; width: 45px; height: 45px;
            background: #000; border: 2px solid #0f0; border-radius: 50%;
            display: flex; justify-content: center; align-items: center;
            box-shadow: 0 0 10px #0f0; cursor: pointer; font-size: 20px;
        }

        /* SMALL SIGNAL WIDGET */
        #signal-widget {
            top: 20%; right: 10px; width: 170px; /* ‡¶è‡¶ï‡¶¶‡¶Æ ‡¶õ‡ßã‡¶ü ‡¶ï‡¶∞‡¶æ ‡¶π‡ßü‡ßá‡¶õ‡ßá */
            background: rgba(0,0,0,0.9); border: 1.5px solid #00ffff;
            border-radius: 8px; color: white; text-align: center; overflow: hidden;
            box-shadow: 0 0 15px rgba(0, 255, 255, 0.3);
        }

        .header { background: #00ffff22; padding: 4px; font-size: 10px; border-bottom: 1px solid #00ffff; font-weight: bold; color: #00ffff; }
        .pattern-box { font-size: 8px; color: #ff00de; margin: 2px; }
        .pred-area { height: 60px; display: flex; align-items: center; justify-content: center; }
        .res-txt { font-size: 32px; font-weight: 900; }
        .big { color: #ffff00; text-shadow: 0 0 10px #ffff00; }
        .small { color: #00ffff; text-shadow: 0 0 10px #00ffff; }
        .skip { color: #ff0000; font-size: 24px; animation: blink 0.5s infinite; }
        
        .status-area { font-size: 10px; padding: 3px; border-top: 1px solid #333; }
        .info-row { display: grid; grid-template-columns: 1fr 1fr; gap: 2px; padding: 5px; font-size: 9px; background: #111; }
        .full-period { font-size: 9px; color: #0f0; margin-bottom: 2px; }
        @keyframes blink { 50% { opacity: 0.3; } }
    </style>
</head>
<body>

    <iframe src="https://hgzy.in/#/register?invitationCode=51226515900" id="game-frame"></iframe>
    <div id="main-skull" class="draggable" onclick="toggleW()">üíÄ</div>

    <div id="signal-widget" class="draggable">
        <div class="header">PINEX MINI MOD</div>
        <div id="pat-trace" class="pattern-box">SCANNING WAIT...</div>
        
        <div class="pred-area">
            <div id="signal-res" class="res-txt" style="color:#555; font-size: 14px;">WAIT...</div>
        </div>

        <div id="streak-box" class="status-area">READY</div>

        <div class="info-row">
            <div>NEXT:<br><span id="next-p" style="color:#fff">-</span></div>
            <div>MATCH:<br><span id="match-count" style="color:#ff00de">0</span></div>
        </div>
        <div class="full-period">FULL P: <span id="full-p">---</span></div>
    </div>

    <script>
        const DB = "https://hidndnd-default-rtdb.firebaseio.com/wingo_records.json";
        let lastP = null, pred = null, streak = 0;

        async function loop() {
            try {
                let r = await fetch(DB);
                let data = await r.json();
                if(!data) return;

                let keys = Object.keys(data).sort();
                let lastData = data[keys[keys.length-1]];
                let curP = lastData.period;

                if(curP !== lastP) {
                    // Win/Loss check
                    if(lastP && pred && pred !== "SKIP") {
                        if(lastData.size === pred) {
                            streak = (streak < 0) ? 1 : streak + 1;
                        } else {
                            streak = (streak > 0) ? -1 : streak - 1;
                        }
                        updateUI(streak);
                    }

                    lastP = curP;
                    document.getElementById('full-p').innerText = (BigInt(curP)+1n).toString();
                    document.getElementById('next-p').innerText = (BigInt(curP)+1n).toString().slice(-4);

                    // 6-Pattern Analysis
                    let analysis = analyze(data, keys);
                    pred = analysis.prediction;
                    showSignal(analysis);
                }
            } catch(e) {}
        }

        function analyze(data, keys) {
            let history = keys.map(k => data[k].size);
            if(history.length < 15) return { prediction: "SKIP", matches: 0 };

            let currentPattern = history.slice(-6); // ‡ß¨ ‡¶ü‡¶æ ‡¶™‡ßç‡¶Ø‡¶æ‡¶ü‡¶æ‡¶∞‡ßç‡¶®
            document.getElementById('pat-trace').innerText = "PAT: " + currentPattern.map(s=>s[0]).join("");

            let bMatch = 0, sMatch = 0, totalMatch = 0;

            for(let i=0; i < history.length - 7; i++) {
                if(JSON.stringify(history.slice(i, i+6)) === JSON.stringify(currentPattern)) {
                    totalMatch++;
                    if(history[i+6] === "BIG") bMatch++; else sMatch++;
                }
            }

            if(totalMatch === 0) return { prediction: "SKIP", matches: 0 };
            
            // ‡¶≤‡¶∏ ‡ß© ‡¶è‡¶∞ ‡¶¨‡ßá‡¶∂‡¶ø ‡¶π‡¶≤‡ßá ‡¶∏‡ßç‡¶ï‡¶ø‡¶™ ‡¶≤‡¶ú‡¶ø‡¶ï
            if(streak <= -3 && totalMatch < 5) return { prediction: "SKIP", matches: totalMatch };

            return {
                prediction: (bMatch >= sMatch) ? "BIG" : "SMALL",
                matches: totalMatch
            };
        }

        function showSignal(a) {
            let el = document.getElementById('signal-res');
            document.getElementById('match-count').innerText = a.matches;
            if(a.prediction === "BIG") { el.innerText = "BIG"; el.className="res-txt big"; }
            else if(a.prediction === "SMALL") { el.innerText = "SMALL"; el.className="res-txt small"; }
            else { el.innerText = "SKIP"; el.className="res-txt skip"; }
        }

        function updateUI(s) {
            let box = document.getElementById('streak-box');
            if(s > 3) { box.innerText = "üî• SUPER WIN "+s; box.style.color="#0f0"; }
            else if(s > 0) { box.innerText = "WIN "+s; box.style.color="#0f0"; }
            else if(s < 0) { box.innerText = "LOSS "+Math.abs(s); box.style.color="#f00"; }
        }

        function toggleW() { let w = document.getElementById('signal-widget'); w.style.display = (w.style.display==='none')?'block':'none'; }

        // Drag
        document.querySelectorAll('.draggable').forEach(el => {
            let isDown=false, x, y;
            el.addEventListener('mousedown', e => { isDown=true; x=e.clientX-el.offsetLeft; y=e.clientY-el.offsetTop; });
            document.addEventListener('mousemove', e => { if(isDown) { el.style.left=(e.clientX-x)+'px'; el.style.top=(e.clientY-y)+'px'; }});
            document.addEventListener('mouseup', () => isDown=false);
            el.addEventListener('touchstart', e => { x=e.touches[0].clientX-el.offsetLeft; y=e.touches[0].clientY-el.offsetTop; }, {passive:true});
            el.addEventListener('touchmove', e => { e.preventDefault(); el.style.left=(e.touches[0].clientX-x)+'px'; el.style.top=(e.touches[0].clientY-y)+'px'; }, {passive:true});
        });

        setInterval(loop, 3000);
    </script>
</body>
</html>
